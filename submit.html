<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Submit Your Book — Noctua Forest</title>
    <meta name="description" content="Submit your manuscript to engaged readers who appreciate quality storytelling across all genres. Join The Forest community." />
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="assets/tailwind.css">
    <link rel="stylesheet" href="assets/base-styles.css">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="icon" type="image/png" sizes="72x72" href="new-favicon/web/icons8-long-eared-owl-feather-icongeek26-glyph-72.png">
    <link rel="icon" type="image/png" sizes="70x70" href="new-favicon/web/icons8-long-eared-owl-feather-icongeek26-glyph-70.png">
    <link rel="stylesheet" href="assets/nav.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;700&family=Noto+Serif:wght@400;600;700&family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0ZWN1Z3DYQ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-0ZWN1Z3DYQ');
    </script>
    <style>
        body {
            font-family: 'Noto Sans', sans-serif;
            background-color: #fbebcc;
            color: #2D3748;
        }
    </style>
  </head>
  <body>
    <a href="#nav" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-forest-accent text-white px-4 py-2 rounded-lg">Skip to navigation</a>
    <a href="#main" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-forest-accent text-white px-4 py-2 rounded-lg">Skip to main content</a>

    <!-- Main Container -->
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Header/Navigation -->
        <header class="flex justify-between items-center mb-12">
            <a href="welcome.html" class="flex items-center space-x-3">
                <!-- Noctua Forest Logo -->
                <img src="images/logo.png" alt="Noctua Forest Logo" width="40" height="40" decoding="async" class="w-10 h-10">
                <span class="text-2xl font-bold" style="font-family: 'Poppins', sans-serif; color: #4A5450;">Noctua Forest</span>
            </a>
            <nav id="nav" class="hidden md:flex items-center space-x-8 text-lg ml-auto" style="font-family: 'Noto Sans', sans-serif;">
                <a href="forest.html" class="nav-link hover:text-forest-accent transition-colors duration-300 font-medium block md:inline-block py-3 md:py-0 px-4 md:px-0">The Forest</a>
                <a href="submit.html" class="nav-link hover:text-forest-accent transition-colors duration-300 font-medium block md:inline-block py-3 md:py-0 px-4 md:px-0">Submit Book</a>
                <!-- Contribute moved to Creator Resources inside dashboard for creators -->
                <a href="about.html" class="nav-link hover:text-forest-accent transition-colors duration-300 font-medium block md:inline-block py-3 md:py-0 px-4 md:px-0">About</a>
            </nav>
            <div class="flex items-center space-x-8">
                <button class="md:hidden" onclick="toggleMobileMenu()" aria-label="Toggle menu">
                     <svg class="w-6 h-6" fill="none" stroke="#4A5450" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
                <a href="account.html" class="hover:text-forest-accent transition-colors duration-300 nav-link" aria-label="Account">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                </a>
            </div>
        </header>
        <div id="navOverlay" class="nav-overlay"></div>
        
        <!-- Breadcrumb Navigation -->
        <nav class="max-w-5xl mx-auto px-4 mb-6" aria-label="Breadcrumb">
            <ol class="breadcrumb flex items-center space-x-2 text-sm">
                <li><a href="welcome.html" class="hover:text-forest-accent transition-colors">Home</a></li>
                <li><span class="mx-2">/</span></li>
                <li class="breadcrumb-current" aria-current="page">Submit Book</li>
            </ol>
        </nav>

    <main id="main" class="max-w-4xl mx-auto px-4">
        <article class="space-y-16">
            <!-- Hero Section -->
            <div class="text-center">
                <h1 class="text-4xl font-bold mb-6 text-[#3A4440]" style="font-family: 'Poppins', sans-serif;">Submit Your Book</h1>
                <p class="text-xl mb-4 text-[#4A5450]">Self-publish and promote your work in The Forest</p>
                <p class="text-lg text-[#4A5450]/80">Create custom reading lists, earn affiliate commissions, and connect with engaged readers. Free to join.</p>
            </div>

        <form id="submissionForm" class="bg-[#4A5450] rounded-xl p-8 text-white space-y-6" novalidate>
          <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-2">
              <label for="email" class="block font-medium text-white mb-1">Your Email</label>
              <input id="email" name="email" type="email" required placeholder="you@example.com" 
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
            </div>
            <div class="space-y-2">
              <label for="author" class="block font-medium text-white mb-1">Author Name</label>
              <input id="author" name="author" type="text" required placeholder="Author Name" 
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
            </div>
          </div>

          <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-2">
              <label for="title" class="block font-medium text-white mb-1">Book Title</label>
              <input id="title" name="title" type="text" required placeholder="Book Title" 
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
            </div>
            <div class="space-y-2">
              <label for="publisher" class="block font-medium text-white mb-1">Publisher (or Self-Published)</label>
              <input id="publisher" name="publisher" type="text" placeholder="Publisher or Self-Published" 
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
            </div>
          </div>

          <div class="space-y-2">
            <label for="blurb" class="block font-medium text-white mb-1">Book Blurb</label>
            <textarea id="blurb" name="blurb" rows="5" required placeholder="Short description of your book"
              class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200"></textarea>
            <p class="text-sm text-gray-300">Aim for 120–200 words. Tell us the premise, tone, and the readers who will enjoy it.</p>
          </div>

          <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-2">
              <label for="wordCount" class="block font-medium text-white mb-1">Word Count</label>
              <input id="wordCount" name="wordCount" type="number" min="0" inputmode="numeric" placeholder="e.g., 65000" 
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
              <p class="text-sm text-gray-300">An estimate helps us plan the reading and set expectations.</p>
            </div>
            <div class="space-y-2">
              <label for="purchaseLink" class="block font-medium text-white mb-1">Book Purchase Link</label>
              <input id="purchaseLink" name="purchaseLink" type="url" placeholder="https://..." 
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
              <p class="text-sm text-gray-300">Used for buy buttons on your book page (Amazon, Bookshop, or similar).</p>
            </div>
            <div class="space-y-2">
              <label for="purchaseLink2" class="block font-medium text-white mb-1">Secondary Purchase Link (optional)</label>
              <input id="purchaseLink2" name="purchaseLink2" type="url" placeholder="https://..." 
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
            </div>
          </div>

          <!-- Cultural Context Section -->
          <fieldset class="space-y-6">
            <legend class="text-lg font-bold mb-4">Cultural Context</legend>
            
            <div class="grid md:grid-cols-2 gap-6">
              <div class="space-y-2">
                <label for="primaryLanguage" class="block font-medium text-white mb-1">Primary Language</label>
                <select id="primaryLanguage" name="primaryLanguage" required
                  class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200">
                  <option value="">Select language</option>
                  <option value="en">English</option>
                  <option value="es">Spanish</option>
                  <option value="fr">French</option>
                  <option value="de">German</option>
                  <option value="it">Italian</option>
                  <option value="pt">Portuguese</option>
                  <option value="ja">Japanese</option>
                  <option value="ko">Korean</option>
                  <option value="zh">Chinese</option>
                  <option value="ar">Arabic</option>
                  <option value="hi">Hindi</option>
                  <option value="ru">Russian</option>
                  <option value="other">Other</option>
                </select>
              </div>
              
              <div class="space-y-2">
                <label for="originalLanguage" class="block font-medium text-white mb-1">Original Language (if translated)</label>
                <select id="originalLanguage" name="originalLanguage"
                  class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200">
                  <option value="">Not a translation</option>
                  <option value="en">English</option>
                  <option value="es">Spanish</option>
                  <option value="fr">French</option>
                  <option value="de">German</option>
                  <option value="it">Italian</option>
                  <option value="pt">Portuguese</option>
                  <option value="ja">Japanese</option>
                  <option value="ko">Korean</option>
                  <option value="zh">Chinese</option>
                  <option value="ar">Arabic</option>
                  <option value="hi">Hindi</option>
                  <option value="ru">Russian</option>
                  <option value="other">Other</option>
                </select>
              </div>
            </div>
            
            <div class="grid md:grid-cols-2 gap-6">
              <div class="space-y-2">
                <label for="authorRegion" class="block font-medium text-white mb-1">Author's Region</label>
                <select id="authorRegion" name="authorRegion" required
                  class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200">
                  <option value="">Select region</option>
                  <option value="north-america">North America</option>
                  <option value="south-america">South America</option>
                  <option value="europe">Europe</option>
                  <option value="africa">Africa</option>
                  <option value="asia">Asia</option>
                  <option value="oceania">Oceania</option>
                  <option value="middle-east">Middle East</option>
                </select>
              </div>
              
              <div class="space-y-2">
                <label for="publicationYear" class="block font-medium text-white mb-1">Publication Year</label>
                <input id="publicationYear" name="publicationYear" type="number" min="1800" max="2030" placeholder="2024"
                  class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
              </div>
            </div>
            
            <div class="space-y-2">
              <label for="culturalThemes" class="block font-medium text-white mb-1">Cultural Themes (optional)</label>
              <input id="culturalThemes" name="culturalThemes" type="text" placeholder="e.g., diaspora, identity, tradition, family heritage"
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
              <p class="text-sm text-gray-300">Themes that reflect cultural experiences or perspectives in your work</p>
            </div>
          </fieldset>

          <!-- Genre & Classification Section -->
          <fieldset class="space-y-6">
            <legend class="text-lg font-bold mb-4">Genre and classification</legend>
            
            <div class="space-y-2">
              <label for="authorTags" class="block font-medium text-white mb-1">Your Genre Tags</label>
              <input id="authorTags" name="authorTags" type="text" placeholder="Type tags separated by commas"
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
              <p class="text-sm text-gray-300">Create your own genre tags (e.g., "dark academia, philosophical fiction, coming-of-age")</p>
              <div id="tagPreview" class="flex flex-wrap gap-2 mt-2"></div>
            </div>
            
            <div class="grid md:grid-cols-2 gap-6">
              <div class="space-y-2">
                <label for="targetAudience" class="block font-medium text-white mb-1">Target Audience (optional)</label>
                <select id="targetAudience" name="targetAudience"
                  class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200">
                  <option value="">Not specified</option>
                  <option value="young-adult">Young Adult</option>
                  <option value="adult">Adult</option>
                  <option value="children">Children</option>
                  <option value="middle-grade">Middle Grade</option>
                  <option value="new-adult">New Adult</option>
                </select>
              </div>
              
              <div class="space-y-2">
                <label for="bookLength" class="block font-medium text-white mb-1">Book Length</label>
                <select id="bookLength" name="bookLength"
                  class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200">
                  <option value="">Not specified</option>
                  <option value="short">Short (under 50k words)</option>
                  <option value="medium">Medium (50k-80k words)</option>
                  <option value="long">Long (80k+ words)</option>
                </select>
              </div>
            </div>
          </fieldset>

          <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-2">
              <label for="coverUrl" class="block font-medium text-white mb-1">Book Cover (URL)</label>
              <input id="coverUrl" name="coverUrl" type="url" placeholder="https://..."
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
            </div>
            <div class="space-y-2">
              <label for="pdfUrl" class="block font-medium text-white mb-1">
                Book (PDF) URL
                <span aria-label="Help" title="Paste a direct HTTPS link to your book's PDF. Use a public link (no login). Example: Firebase Storage download URL. Avoid Google Drive preview pages.">🛈</span>
              </label>
              <input id="pdfUrl" name="pdfUrl" type="url" placeholder="Direct public link to your PDF (https://…)"
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
            </div>
          </div>

          <div class="grid md:grid-cols-2 gap-6">
            <div class="space-y-2">
              <label for="amazonUrl" class="block font-medium text-white mb-1">Amazon Book URL (optional)</label>
              <input id="amazonUrl" name="amazonUrl" type="url" placeholder="https://amazon.com/dp/..."
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
              <p class="text-sm text-gray-300">Help readers find your book on Amazon</p>
            </div>
            <div class="space-y-2">
              <label for="isbn" class="block font-medium text-white mb-1">ISBN (optional)</label>
              <input id="isbn" name="isbn" type="text" placeholder="978-0-123456-78-9"
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
              <p class="text-sm text-gray-300">Your book's ISBN for easier discovery</p>
            </div>
            <div class="space-y-2">
              <label for="asin" class="block font-medium text-white mb-1">Amazon ASIN (optional)</label>
              <input id="asin" name="asin" type="text" placeholder="B0XXXXXXXX"
                class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
              <p class="text-sm text-gray-300">Your book's Amazon ASIN (10-character identifier)</p>
            </div>
          </div>

          <div class="space-y-2">
            <label for="coverFile" class="block font-medium text-white mb-1">Or upload cover (PNG/JPG)</label>
            <input id="coverFile" name="coverFile" type="file" accept="image/*"
              class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
            <p class="text-sm text-gray-300">If both URL and file are provided, the uploaded file will be used.</p>
          </div>

          <div class="space-y-2">
            <label for="contentWarnings" class="block font-medium text-white mb-1">Content Warnings (optional)</label>
            <input id="contentWarnings" name="contentWarnings" type="text" placeholder="e.g., violence, grief"
              class="w-full px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-[#F58220] transition-colors duration-200" />
          </div>

          <div class="bg-[#5A6560] rounded-lg p-4 border border-[#7A8580]">
            <label class="flex items-center space-x-3">
              <input type="checkbox" id="premiumReview" class="w-5 h-5 rounded border-[#7A8580] bg-[#4A5450] checked:bg-[#F58220]" />
              <span class="font-bold">Noctua Forest + Staff Book Review</span>
            </label>
            <div class="text-sm text-gray-200 mt-2 space-y-1">
              <p>Approximately 500 words from our staff, pinned on your books page.</p>
              <p>Possible feature exposure on our landing page, newsletters, or social media when we think it's a good fit.</p>
              <p>Turnaround: typically 1–2 weeks depending on queue.</p>
              <p class="text-gray-300">This includes a <a href="https://buy.stripe.com/6oU9ATfwO5mJ9PY9tQaVa02" class="underline hover:text-white">$4.99 monthly membership</a> to The Forest with creator network access. The staff review is one-time. <a href="https://book.stripe.com/8x214n70i5mJ1js7lIaVa01" class="underline hover:text-white">Purchase here</a>.</p>
            </div>
            <div class="text-xs text-gray-300 mt-3">
              <p>Refund policy: If we decline your book or cannot fulfill the review within the timeframe, you may request a refund.</p>
              <p class="mt-1">We don't sell retailer reviews. This is an editorial review for your site and readers.</p>
            </div>
          </div>

          <div class="mt-8">
            <button type="submit" 
              class="w-full md:w-auto px-8 py-3 bg-[#F58220] hover:bg-[#E67615] text-white font-medium rounded-full transition duration-300">
              Get Reviewed
            </button>
            <p id="submissionSuccess" class="hidden mt-4 text-green-400">Thank you! Your submission was received.</p>
          </div>
        </form>

        <!-- Submission Modal -->
        <div id="submissionModal" class="hidden fixed inset-0 bg-black/60 items-center justify-center">
          <div class="bg-white rounded-xl w-full max-w-md mx-4 p-6">
            <h3 class="text-xl font-bold mb-2 text-[#4A5450]">Thanks for your submission</h3>
            <p id="submissionModalDesc" class="text-gray-700 mb-4">We'll review it shortly.</p>
            <div id="premiumCta" class="hidden bg-amber-50 border border-amber-200 text-amber-800 rounded-md p-3 mb-4">
              Want to boost your visibility and earnings? Upgrade to premium for better features and commission rates.
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
              <button id="modalSubmitAnother" class="px-4 py-2 bg-[#F58220] hover:bg-[#E67615] text-white rounded-md">Submit Another</button>
              <a id="modalViewDashboard" href="dashboard.html" class="px-4 py-2 text-center bg-[#5A6560] hover:bg-[#6A7570] text-white rounded-md">Dashboard</a>
              <button id="modalPremium" class="hidden px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-md">Noctua Forest + Staff Book Review</button>
            </div>
          </div>
        </div>
      </div>
    </main>



    <script>
      window.__STRIPE_PREMIUM_REVIEW_LINK__ = 'https://book.stripe.com/8x214n70i5mJ1js7lIaVa01';
    </script>
    <script type="module">
      import { app, db } from './firebase-config.js';
      import { getAuth } from 'https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js';
      import { collection, addDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js';
      import { handleFormSubmission } from './js/formHandler.js';
      import showAlphaPopup from './components/AlphaPopup.js';

      const auth = getAuth(app);

      // Show alpha popup on first visit
      showAlphaPopup();

      // Initialize form handler (uses shared app from firebase-config.js)
      document.getElementById('submissionForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const form = e.target;
        const data = Object.fromEntries(new FormData(form));
        try {
          await handleFormSubmission('book', data);
          showSubmissionModal({
            title: data.title,
            premium: form.querySelector('#premiumReview').checked,
            stripeLink: window.__STRIPE_PREMIUM_REVIEW_LINK__
          });
        } catch (error) {
          console.error('Submission failed:', error);
          alert('Failed to submit book. Please try again.');
        }
      });

      // Modal controller for submission
      window.showSubmissionModal = ({ premium, stripeLink, title }) => {
        const modal = document.getElementById('submissionModal');
        const desc = document.getElementById('submissionModalDesc');
        const premiumBox = document.getElementById('premiumCta');
        const premiumBtn = document.getElementById('modalPremium');
        const submitAnother = document.getElementById('modalSubmitAnother');
        if (!modal) return;
        if (title) desc.textContent = `"${title}" was received. We'll review it shortly.`;

        // Configure premium area
        if (premium && stripeLink) {
          premiumBox.classList.remove('hidden');
          premiumBtn.classList.remove('hidden');
          premiumBtn.onclick = () => window.open(stripeLink, '_blank', 'noopener');
        } else {
          premiumBox.classList.add('hidden');
          premiumBtn.classList.add('hidden');
          premiumBtn.onclick = null;
        }

        // Submit another (refresh form)
        submitAnother.onclick = () => {
          modal.classList.add('hidden');
          try { document.getElementById('submissionForm').reset(); } catch (_) {}
          window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        // Show modal
        modal.classList.remove('hidden');
        modal.classList.add('flex');
      };

      // Restore form data if returning from signup
      const savedFormData = sessionStorage.getItem('savedFormData');
      if (savedFormData) {
        const { type, data } = JSON.parse(savedFormData);
        if (type === 'book') {
          Object.entries(data).forEach(([key, value]) => {
            const input = document.getElementById(key);
            if (input) {
              if (input.type === 'checkbox') {
                input.checked = value === 'on';
              } else {
                input.value = value;
              }
            }
          });
          // Clear saved data
          sessionStorage.removeItem('savedFormData');
        }
      }
    </script>

    <script src="assets/nav.js"></script>
  </body>
</html>


