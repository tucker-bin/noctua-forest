<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Noctua Forest">
    <meta name="theme-color" content="#4A5450">
    <title>Dashboard - Noctua Forest</title>
    <link rel="stylesheet" href="assets/tailwind.css">
    <link rel="stylesheet" href="assets/base-styles.css">
    <link rel="stylesheet" href="assets/nav.css">
    <!-- Tailwind is precompiled into assets/tailwind.css; CDN config not needed -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;700&family=Noto+Serif:wght@400;600;700&family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0ZWN1Z3DYQ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-0ZWN1Z3DYQ');
    </script>
</head>
<body class="bg-[#fbebcc]">
    <!-- Header -->
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <header class="flex justify-between items-center">
            <a href="welcome.html" class="flex items-center space-x-3">
                <img src="images/logo-40.png" srcset="images/logo-40.png 1x, images/logo-80.png 2x, images/logo-120.png 3x" sizes="40px" alt="Noctua Forest Logo" width="40" height="40" decoding="async" class="w-10 h-10">
                <span class="text-2xl font-bold" style="font-family: 'Poppins', sans-serif; color: #4A5450;">Noctua Forest</span>
            </a>
            <nav id="nav" class="hidden md:flex items-center space-x-8 text-lg ml-auto" style="font-family: 'Noto Sans', sans-serif;">
                <a href="forest.html" class="nav-link hover:text-forest-accent transition-colors duration-300 font-medium block md:inline-block py-3 md:py-0 px-4 md:px-0">The Forest</a>
                <a href="submit.html" class="nav-link hover:text-forest-accent transition-colors duration-300 font-medium block md:inline-block py-3 md:py-0 px-4 md:px-0">Submit Book</a>
                <!-- Contribute link intentionally omitted here; creators see it in Creator Resources -->
                <a href="about.html" class="nav-link hover:text-forest-accent transition-colors duration-300 font-medium block md:inline-block py-3 md:py-0 px-4 md:px-0">About</a>
            </nav>
            <div class="flex items-center space-x-8">
                <button onclick="toggleMobileMenu()" class="md:hidden" aria-label="Toggle menu">
                    <svg class="w-6 h-6" fill="none" stroke="#4A5450" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                    </svg>
                </button>
                <a href="account.html" class="hover:text-forest-accent transition-colors duration-300 nav-link" aria-label="Account">
                    <svg class="w-6 h-6" fill="none" stroke="#4A5450" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                </a>
            </div>
        </header>
    </div>
    <div id="navOverlay" class="nav-overlay"></div>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="max-w-5xl mx-auto">
            <!-- Welcome Section -->
            <div class="bg-forest-card rounded-xl p-8 mb-12">
                <div class="flex justify-between items-center mb-8">
                    <div>
                        <h1 class="text-3xl font-bold text-white mb-2" id="welcomeMessage">Welcome back!</h1>
                        <p class="text-gray-200" id="userEmail"></p>
                    </div>
                    <button id="signout" class="text-gray-200 hover:text-white transition-colors duration-300">
                        Sign Out
                    </button>
                </div>

                <!-- Stats Overview -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-forest-secondary rounded-lg p-6">
                        <div class="flex items-center mb-2">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                            </svg>
                            <h3 class="text-lg font-semibold text-white">Your Books</h3>
                        </div>
                        <p id="booksCount" class="text-3xl font-bold text-white">0</p>
                    </div>
                    <div class="bg-forest-secondary rounded-lg p-6">
                        <div class="flex items-center mb-2">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                            </svg>
                            <h3 class="text-lg font-semibold text-white">Reading List</h3>
                        </div>
                        <p id="readingListCount" class="text-3xl font-bold text-white">0</p>
                    </div>
                    <div class="bg-forest-accent rounded-lg p-6">
                        <div class="flex items-center mb-2">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                            </svg>
                            <h3 class="text-lg font-semibold text-white">Reviews Written</h3>
                        </div>
                        <p id="reviewsCount" class="text-3xl font-bold text-white">0</p>

                    </div>
                </div>
            </div>

            <!-- Your Books -->
            <div class="bg-forest-card rounded-xl p-8 mb-8">
                <div class="flex items-center mb-6">
                    <svg class="w-7 h-7 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                    </svg>
                    <h2 class="text-2xl font-bold text-white">Your Books</h2>
                </div>
                <div id="submissionsList" class="space-y-4">
                    <!-- Books will be populated here -->
                </div>
            </div>

            <!-- Reading Lists -->
            <div class="bg-forest-card rounded-xl p-8 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center">
                        <svg class="w-7 h-7 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                        </svg>
                        <h2 class="text-2xl font-bold text-white">Reading Lists</h2>
                    </div>
                    <button id="createList" class="px-4 py-2 bg-forest-accent text-white rounded-full hover:opacity-90 transition-opacity flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                        </svg>
                        New List
                    </button>
                </div>

                <!-- List Controls -->
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center space-x-4">
                        <select id="listSort" class="bg-[#3A4440] text-white rounded-lg px-3 py-2 border border-[#7A8580]">
                            <option value="updated">Last Updated</option>
                            <option value="name">Name</option>
                            <option value="books">Book Count</option>
                        </select>
                        <input type="text" id="listSearch" placeholder="Search lists..." 
                            class="bg-[#3A4440] text-white rounded-lg px-3 py-2 border border-[#7A8580] placeholder-gray-400">
                    </div>
                </div>

                <!-- Lists Grid -->
                <div id="readingLists" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Lists will be populated here -->
                </div>

                <!-- Empty State -->
                <div id="emptyLists" class="hidden text-center py-8">
                    <p class="text-white/80 mb-4">You haven't created any reading lists yet.</p>
                    <button class="create-list-btn px-5 py-2 bg-forest-accent text-white rounded-full hover:opacity-90">
                        Create Your First List
                    </button>
                </div>
            </div>

            <!-- List Edit Modal -->
            <div id="listModal" class="hidden fixed inset-0 bg-black/60 items-center justify-center z-50">
                <div class="bg-forest-card rounded-xl w-full max-w-lg mx-4 p-6">
                    <h3 class="text-xl font-bold mb-4 text-white">Edit List</h3>
                    <form id="listForm" class="space-y-4">
                        <div>
                            <label for="listName" class="block text-sm font-medium text-white/90 mb-1">List Name</label>
                            <input type="text" id="listName" required
                                class="w-full px-4 py-2 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white">
                        </div>
                        <div>
                            <label for="listDescription" class="block text-sm font-medium text-white/90 mb-1">Description (Optional)</label>
                            <textarea id="listDescription" rows="3"
                                class="w-full px-4 py-2 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white"></textarea>
                        </div>
                        <div class="flex justify-end gap-3">
                            <button type="button" id="cancelList" class="px-4 py-2 bg-[#3A4440] text-white rounded-full hover:opacity-90">
                                Cancel
                            </button>
                            <button type="submit" class="px-4 py-2 bg-forest-accent text-white rounded-full hover:opacity-90">
                                Save List
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Share Modal -->
            <div id="shareModal" class="hidden fixed inset-0 bg-black/60 items-center justify-center z-50">
                <div class="bg-forest-card rounded-xl w-full max-w-lg mx-4 p-6">
                    <h3 class="text-xl font-bold mb-4 text-white">Share List</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-white/90 mb-1">Shareable Link</label>
                            <div class="flex gap-2">
                                <input type="text" id="shareLink" readonly
                                    class="flex-1 px-4 py-2 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white">
                                <button id="copyLink" class="px-4 py-2 bg-forest-accent text-white rounded-lg hover:opacity-90">
                                    Copy
                                </button>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-white/90 mb-2">Share On</label>
                            <div class="flex gap-3">
                                <button id="shareTwitter" class="flex-1 px-4 py-2 bg-[#1DA1F2] text-white rounded-lg hover:opacity-90">
                                    Twitter
                                </button>
                                <button id="shareFacebook" class="flex-1 px-4 py-2 bg-[#4267B2] text-white rounded-lg hover:opacity-90">
                                    Facebook
                                </button>
                            </div>
                        </div>
                        <div id="qrCodeContainer" class="hidden text-center">
                            <label class="block text-sm font-medium text-white/90 mb-2">QR Code</label>
                            <div id="qrCode" class="inline-block bg-white p-4 rounded-lg"></div>
                        </div>
                        <div class="flex justify-end">
                            <button id="closeShare" class="px-4 py-2 bg-[#3A4440] text-white rounded-full hover:opacity-90">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Manage Your Reviews -->
            <div class="bg-forest-card rounded-xl p-8">
                <div class="flex items-center mb-6">
                    <svg class="w-7 h-7 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                    </svg>
                    <h2 class="text-2xl font-bold text-white">Manage Your Reviews</h2>
                </div>
                <div id="reviewsList" class="space-y-4">
                    <!-- Reviews will be populated here -->
                </div>
            </div>

            <!-- Creator Resources (hidden for non-creators) -->
            <div id="creatorResources" class="hidden bg-forest-card rounded-2xl p-8 mt-8">
                <div class="flex items-center mb-6">
                    <svg class="w-7 h-7 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                    </svg>
                    <h2 class="text-2xl font-bold text-white">Creator Resources</h2>
                </div>
                <p class="text-white/90 mb-4">Authenticity wins. Share books you truly enjoy. Your commission terms:</p>
                <ul class="list-disc pl-5 text-white/90 space-y-1 mb-6">
                    <li>Amazon sales: <strong>2.5%</strong> (all creators)</li>
                    <li>Bookshop.org sales: <strong>5%</strong> (new) / <strong>7.5%</strong> (VIP)</li>
                    <li>Premium Review referrals: <strong>5%</strong> (new) / <strong>10%</strong> (VIP)</li>
                </ul>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-forest-secondary rounded-xl p-6 text-white">
                        <h3 class="font-semibold mb-2">Your creator code</h3>
                        <div class="flex items-center gap-3">
                            <code id="creatorCode" class="px-3 py-1 bg-[#3A4440] rounded">—</code>
                            <button id="copyCode" class="px-3 py-1 bg-forest-accent rounded text-white hover:opacity-90">Copy</button>
                        </div>
                        <p class="text-white/80 text-sm mt-2">Use this code in your links to track referrals.</p>
                    </div>
                    <div class="bg-forest-secondary rounded-xl p-6 text-white">
                        <h3 class="font-semibold mb-2">Share links</h3>
                        <div class="space-y-2 text-sm">
                            <div>
                                <div class="mb-1">Site link</div>
                                <div class="flex gap-2">
                                    <input id="siteLink" class="flex-1 px-3 py-2 rounded bg-[#3A4440] border border-[#7A8580]" readonly />
                                    <button id="copySite" class="px-3 py-2 bg-forest-accent rounded text-white hover:opacity-90">Copy</button>
                                </div>
                            </div>
                            <div>
                                <div class="mb-1">Example book link</div>
                                <div class="flex gap-2">
                                    <input id="bookLink" class="flex-1 px-3 py-2 rounded bg-[#3A4440] border border-[#7A8580]" readonly />
                                    <button id="copyBook" class="px-3 py-2 bg-forest-accent rounded text-white hover:opacity-90">Copy</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Creator blogging resources -->
                <div class="mt-6 grid md:grid-cols-2 gap-6">
                    <div class="bg-forest-secondary rounded-xl p-6 text-white">
                        <h3 class="font-semibold mb-2">Write for our Blog (Medium)</h3>
                        <p class="text-white/80 text-sm mb-3">Share essays, reviews, or interviews for the Noctua Forest blog on Medium. Contributors can link their creator code in posts to earn commission from referred readers.</p>
                        <a href="contributor.html" class="inline-block px-4 py-2 bg-forest-accent text-white rounded-md hover:opacity-90">Open Contributor Page</a>
                    </div>
                </div>
                <div class="mt-6 bg-[#3A4440] rounded-lg p-4 text-white/90 text-sm">
                    <p class="font-semibold mb-1">Suggested caption</p>
                    <p id="suggestedCaption">I only share books I genuinely enjoy. Explore my picks on Noctua Forest: <span class="underline" id="captionLink">—</span></p>
                </div>
            </div>
            <!-- Settings -->
            <div class="bg-forest-card rounded-xl p-8 mt-8">
                <div class="flex items-center mb-6">
                    <svg class="w-7 h-7 mr-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 15c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <h2 class="text-2xl font-bold text-white">Settings</h2>
                </div>
                <!-- Creator Application Status -->
                <div id="creatorApplicationStatus" class="hidden md:col-span-2 bg-forest-accent rounded-xl p-6 mb-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-white">Creator Application</h3>
                            <p class="text-white/90 text-sm mt-1">Your application is being reviewed</p>
                        </div>
                        <div class="flex items-center">
                            <svg class="w-5 h-5 text-white animate-spin mr-2" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            <span class="text-white font-medium">Pending Review</span>
                        </div>
                    </div>
                </div>

                <!-- Creator Application CTA -->
                <div id="creatorApplicationCTA" class="hidden md:col-span-2 bg-forest-secondary rounded-xl p-6 mb-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-white">Become a Creator</h3>
                            <p class="text-white/90 text-sm mt-1">Share books you love and earn commission</p>
                        </div>
                        <a href="creator-application.html" class="px-5 py-2 bg-forest-accent text-white rounded-full hover:opacity-90 transition-opacity">
                            Apply Now
                        </a>
                    </div>
                </div>

                <form id="settingsForm" class="grid grid-cols-1 md:grid-cols-2 gap-6 text-white">
                    <!-- Forest Name -->
                    <div class="md:col-span-2 bg-forest-secondary rounded-xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <label for="forestName" class="block text-lg font-semibold mb-1">Forest Name</label>
                                <p class="text-white/80 text-sm">Your unique identity in the Noctua Forest community</p>
                            </div>
                            <div class="relative group">
                                <button type="button" class="text-white/60 hover:text-white" aria-label="Forest Name Info">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                    </svg>
                                </button>
                                <div class="hidden group-hover:block absolute right-0 top-full mt-2 w-64 p-4 bg-[#3A4440] rounded-lg shadow-lg text-sm text-white/90 z-10">
                                    Your Forest Name is used when you write reviews and interact with the community. It's generated from nature-themed words to maintain a consistent atmosphere in the forest.
                                </div>
                            </div>
                        </div>
                        <div class="flex gap-3">
                            <input id="forestName" type="text" readonly class="flex-1 px-4 py-3 rounded-lg bg-[#3A4440] border border-[#7A8580] text-white focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-transparent" />
                            <button type="button" id="regenerateForestName" class="px-4 py-2 bg-forest-accent text-white rounded-lg hover:opacity-90 transition-opacity">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Social Links -->
                    <div class="md:col-span-2">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold">Social Links</h3>
                            <div class="relative group">
                                <button type="button" class="text-white/60 hover:text-white" aria-label="Social Links Info">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                    </svg>
                                </button>
                                <div class="hidden group-hover:block absolute right-0 top-full mt-2 w-64 p-4 bg-[#3A4440] rounded-lg shadow-lg text-sm text-white/90 z-10">
                                    Your social links are displayed on your profile and can be updated here or through the creator application form.
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label for="website" class="block text-sm mb-1">Website</label>
                        <input id="website" type="url" placeholder="https://example.com" class="w-full px-4 py-3 rounded-lg bg-forest-secondary border border-[#7A8580] placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-transparent" />
                    </div>
                    <div>
                        <label for="medium" class="block text-sm mb-1">Medium</label>
                        <input id="medium" type="url" placeholder="https://medium.com/@handle" class="w-full px-4 py-3 rounded-lg bg-forest-secondary border border-[#7A8580] placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-transparent" />
                    </div>
                    <div>
                        <label for="twitter" class="block text-sm mb-1">Twitter/X</label>
                        <input id="twitter" type="url" placeholder="https://twitter.com/handle" class="w-full px-4 py-3 rounded-lg bg-forest-secondary border border-[#7A8580] placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-transparent" />
                    </div>
                    <div>
                        <label for="instagram" class="block text-sm mb-1">Instagram</label>
                        <input id="instagram" type="url" placeholder="https://instagram.com/handle" class="w-full px-4 py-3 rounded-lg bg-forest-secondary border border-[#7A8580] placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-transparent" />
                    </div>
                    <div>
                        <label for="bluesky" class="block text-sm mb-1">Bluesky</label>
                        <input id="bluesky" type="url" placeholder="https://bsky.app/profile/handle" class="w-full px-4 py-3 rounded-lg bg-forest-secondary border border-[#7A8580] placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-transparent" />
                    </div>
                    <div>
                        <label for="youtube" class="block text-sm mb-1">YouTube</label>
                        <input id="youtube" type="url" placeholder="https://youtube.com/@channel" class="w-full px-4 py-3 rounded-lg bg-forest-secondary border border-[#7A8580] placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-transparent" />
                    </div>
                    <div>
                        <label for="tiktok" class="block text-sm mb-1">TikTok</label>
                        <input id="tiktok" type="url" placeholder="https://www.tiktok.com/@handle" class="w-full px-4 py-3 rounded-lg bg-forest-secondary border border-[#7A8580] placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-[#F58220] focus:border-transparent" />
                    </div>
                    <div class="flex items-end gap-3 flex-wrap">
                        <button id="saveSettings" type="submit" class="px-6 py-3 bg-forest-accent text-white rounded-full hover:opacity-90">Save Settings</button>
                        <a href="api-docs.html" class="px-6 py-3 bg-[#4A5450] text-white rounded-full hover:opacity-90">API Docs</a>
                        <a href="contact.html" class="px-6 py-3 bg-[#F58220] text-white rounded-full hover:opacity-90">Contact Us</a>
                    </div>
                </form>
                <p id="settingsStatus" class="text-sm mt-3 text-gray-200"></p>
            </div>
        </div>
    </main>

    <script>
        function toggleMobileMenu() {
            const nav = document.getElementById('nav');
            if (!nav) return;
            const isHidden = nav.classList.contains('hidden');
            nav.classList.toggle('hidden');
            nav.classList.toggle('flex');
            nav.classList.toggle('flex-col');
            // Unified mobile nav look
            nav.classList.toggle('nf-mobile-nav');
            if (isHidden) {
                nav.style.backgroundColor = '#3A4440';
                nav.style.color = '#E0E2DB';
                nav.querySelectorAll('a').forEach(function(a){ a.style.setProperty('color', '#E0E2DB', 'important'); a.classList.add('block'); a.classList.add('py-3'); a.classList.add('px-4'); a.classList.remove('md:py-0'); a.classList.remove('md:px-0'); });
            } else {
                nav.style.backgroundColor = '';
                nav.style.color = '';
                nav.querySelectorAll('a').forEach(function(a){ a.style.color = ''; });
            }
        }
        document.addEventListener('DOMContentLoaded', () => {
            const menuButton = document.querySelector('button[onclick="toggleMobileMenu()"]');
            if (menuButton) {
                menuButton.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    toggleMobileMenu();
                }, { passive: false });
            }
        });
    </script>
    <script type="module">
        import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js';
        import { doc, getDoc, collection, query, where, getDocs, deleteDoc, orderBy, setDoc, updateDoc } from 'https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js';
        import { 
            createList, getUserLists, updateList, deleteList, shareList 
        } from './js/readingListService.js';
        import { app as firebaseApp, db as firebaseDb } from './firebase-config.js';

        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', () => {
            // console.log('DOM loaded, setting up Firebase...');

            // Use initialized Firebase from firebase-config.js
            const app = firebaseApp;
            const auth = getAuth(app);
            const db = firebaseDb;

            // Set up sign out handler (single source of truth)
            const signoutBtn = document.getElementById('signout');
            // console.log('Sign out button found:', signoutBtn);
            if (signoutBtn) {
                signoutBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    // console.log('Sign out clicked');
                    try {
                        await signOut(auth);
                        // console.log('Firebase sign out successful');
                        window.location.href = 'account.html';
                    } catch (error) {
                        console.error('Error signing out:', error);
                        alert('Error signing out. Please try again.');
                    }
                });
            }

            // Handle auth state
            onAuthStateChanged(auth, async (user) => {
            if (!user) {
                window.location.href = 'account.html';
                return;
            }

            // Check if admin (gracefully handle permission-denied)
            try {
                const userDoc = await getDoc(doc(db, 'users', user.uid));
                if (userDoc.exists() && userDoc.data().isAdmin) {
                    window.location.href = 'admin/dashboard.html';
                    return;
                }
            } catch (err) {
                console.warn('User admin check failed (continuing as non-admin):', err);
            }

            // Display user info
            document.getElementById('userEmail').textContent = user.email;

            // Load books and update stats
            const submissionsList = document.getElementById('submissionsList');
            let booksSnap;
            try {
                const booksQuery = query(collection(db, 'books'), where('userId', '==', user.uid));
                booksSnap = await getDocs(booksQuery);
                document.getElementById('booksCount').textContent = booksSnap.size;
            } catch (err) {
                console.warn('Books query failed:', err);
                booksSnap = { empty: true, forEach: () => {} };
                document.getElementById('booksCount').textContent = '0';
            }
            
            if (booksSnap.empty) {
                submissionsList.innerHTML = `
                    <div class="text-gray-200">
                        No books yet. 
                        <a href="submit.html" class="text-forest-accent hover:text-forest-accent/80">Submit your first book</a>
                    </div>
                `;
            } else {
                submissionsList.innerHTML = '';
                booksSnap.forEach(doc => {
                    const data = doc.data();
                    const div = document.createElement('div');
                    div.className = 'bg-forest-secondary p-6 rounded-lg';
                    div.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="font-bold text-white text-lg">${data.title}</h3>
                                <p class="text-gray-200 mt-1">Published ${new Date(data.publishedAt.toDate()).toLocaleDateString()}</p>
                                <p class="text-gray-300 mt-2">${data.blurb.substring(0, 150)}${data.blurb.length > 150 ? '...' : ''}</p>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="editBook('${doc.id}')" class="text-gray-200 hover:text-white transition-colors duration-300">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    `;
                    submissionsList.appendChild(div);
                });
            }

            // Load reading lists
            const listsContainer = document.getElementById('readingLists');
            const emptyState = document.getElementById('emptyLists');
            const listModal = document.getElementById('listModal');
            const listForm = document.getElementById('listForm');
            const shareModal = document.getElementById('shareModal');
            let currentListId = null;

            async function loadLists() {
                try {
                    const lists = await getUserLists(user.uid);
                    document.getElementById('readingListCount').textContent = lists.length;
                    
                    if (lists.length === 0) {
                        listsContainer.innerHTML = '';
                        emptyState.classList.remove('hidden');
                        return;
                    }

                    emptyState.classList.add('hidden');
                    listsContainer.innerHTML = '';
                    
                    lists.forEach(list => {
                        const div = document.createElement('div');
                        div.className = 'bg-forest-secondary p-6 rounded-lg border border-[#7A8580] hover:border-[#F58220] transition-colors duration-300';
                        
                        // Create book cover collage or placeholder
                        const coverHtml = list.books && list.books.length > 0 
                            ? `<div class="grid grid-cols-2 gap-2 mb-4 aspect-[4/3]">
                                ${list.books.slice(0, 4).map(book => `
                                    <img src="${book.coverUrl || 'images/placeholder.jpg'}" 
                                        alt="${book.title}" 
                                        class="w-full h-full object-cover rounded-lg"
                                        loading="lazy">
                                `).join('')}
                               </div>`
                            : `<div class="bg-[#3A4440] rounded-lg mb-4 aspect-[4/3] flex items-center justify-center">
                                <svg class="w-12 h-12 text-white/30" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                </svg>
                               </div>`;
                        
                        const bookCount = list.books?.length || 0;
                        const lastUpdate = list.updatedAt?.toDate 
                            ? list.updatedAt.toDate().toLocaleDateString() 
                            : 'Recently';
                        
                        div.innerHTML = `
                            ${coverHtml}
                            <div class="flex justify-between items-start mb-2">
                                <div class="flex-1">
                                    <h3 class="font-bold text-white text-lg">${list.name}</h3>
                                    <p class="text-white/60 text-sm">${bookCount} book${bookCount !== 1 ? 's' : ''}</p>
                                </div>
                                <div class="flex gap-2">
                                    <button onclick="editList('${list.id}')" class="text-white/60 hover:text-white transition-colors duration-300" title="Edit list">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                                        </svg>
                                    </button>
                                    <button onclick="shareList('${list.id}')" class="text-white/60 hover:text-white transition-colors duration-300" title="Share list">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
                                        </svg>
                                    </button>
                                    <button onclick="deleteList('${list.id}')" class="text-white/60 hover:text-red-400 transition-colors duration-300" title="Delete list">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            ${list.description ? `<p class="text-white/80 text-sm">${list.description}</p>` : ''}
                            <p class="text-white/60 text-xs mt-2">Updated: ${lastUpdate}</p>
                        `;
                        listsContainer.appendChild(div);
                    });
                } catch (err) {
                    console.error('Failed to load lists:', err);
                    listsContainer.innerHTML = `
                        <div class="text-white/60 text-center py-4">
                            Unable to load reading lists. Please try again.
                        </div>
                    `;
                }
            }

            // Create/Edit List
            document.getElementById('createList').addEventListener('click', () => {
                currentListId = null;
                listForm.reset();
                listModal.classList.remove('hidden');
                listModal.classList.add('flex');
            });

            document.querySelectorAll('.create-list-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    currentListId = null;
                    listForm.reset();
                    listModal.classList.remove('hidden');
                    listModal.classList.add('flex');
                });
            });

            document.getElementById('cancelList').addEventListener('click', () => {
                listModal.classList.add('hidden');
                listModal.classList.remove('flex');
            });

            listForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('listName').value.trim();
                const description = document.getElementById('listDescription').value.trim();

                try {
                    if (currentListId) {
                        await updateList(currentListId, { name, description });
                    } else {
                        await createList(user.uid, name, description);
                    }
                    listModal.classList.add('hidden');
                    listModal.classList.remove('flex');
                    await loadLists();
                } catch (err) {
                    console.error('Failed to save list:', err);
                    alert('Failed to save list. Please try again.');
                }
            });

            // Share List
            window.shareList = async (listId) => {
                try {
                    const shareId = await shareList(listId);
                    const shareLink = `${window.location.origin}/lists.html?id=${shareId}`;
                    document.getElementById('shareLink').value = shareLink;
                    
                    // Show QR code
                    const qrContainer = document.getElementById('qrCodeContainer');
                    const qrCode = document.getElementById('qrCode');
                    qrContainer.classList.remove('hidden');
                    
                    // Use QRCode.js or similar library here
                    if (window.QRCode) {
                        qrCode.innerHTML = '';
                        new QRCode(qrCode, {
                            text: shareLink,
                            width: 128,
                            height: 128
                        });
                    }
                    
                    shareModal.classList.remove('hidden');
                    shareModal.classList.add('flex');
                } catch (err) {
                    console.error('Failed to share list:', err);
                    alert('Failed to generate share link. Please try again.');
                }
            };

            // Copy share link
            document.getElementById('copyLink').addEventListener('click', () => {
                const linkInput = document.getElementById('shareLink');
                linkInput.select();
                document.execCommand('copy');
                const btn = document.getElementById('copyLink');
                btn.textContent = 'Copied!';
                setTimeout(() => btn.textContent = 'Copy', 2000);
            });

            // Social sharing
            document.getElementById('shareTwitter').addEventListener('click', () => {
                const url = document.getElementById('shareLink').value;
                window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=Check out my reading list on Noctua Forest!`);
            });

            document.getElementById('shareFacebook').addEventListener('click', () => {
                const url = document.getElementById('shareLink').value;
                window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`);
            });

            document.getElementById('closeShare').addEventListener('click', () => {
                shareModal.classList.add('hidden');
                shareModal.classList.remove('flex');
            });

            // Edit List
            window.editList = async (listId) => {
                try {
                    const list = await getList(listId);
                    if (!list) throw new Error('List not found');
                    
                    currentListId = listId;
                    document.getElementById('listName').value = list.name;
                    document.getElementById('listDescription').value = list.description || '';
                    
                    listModal.classList.remove('hidden');
                    listModal.classList.add('flex');
                } catch (err) {
                    console.error('Failed to load list:', err);
                    alert('Failed to load list details. Please try again.');
                }
            };

            // Delete List
            window.deleteList = async (listId) => {
                if (!confirm('Are you sure you want to delete this list?')) return;
                
                try {
                    await deleteList(listId);
                    await loadLists();
                } catch (err) {
                    console.error('Failed to delete list:', err);
                    alert('Failed to delete list. Please try again.');
                }
            };

            // Search and Sort
            const searchInput = document.getElementById('listSearch');
            const sortSelect = document.getElementById('listSort');
            
            searchInput.addEventListener('input', async () => {
                const query = searchInput.value.toLowerCase();
                const lists = await getUserLists(user.uid);
                
                const filtered = lists.filter(list => 
                    list.name.toLowerCase().includes(query) ||
                    list.description?.toLowerCase().includes(query)
                );
                
                renderLists(filtered);
            });
            
            sortSelect.addEventListener('change', async () => {
                const lists = await getUserLists(user.uid);
                const sortBy = sortSelect.value;
                
                lists.sort((a, b) => {
                    switch (sortBy) {
                        case 'name':
                            return a.name.localeCompare(b.name);
                        case 'books':
                            return (b.books?.length || 0) - (a.books?.length || 0);
                        case 'updated':
                        default:
                            return b.updatedAt - a.updatedAt;
                    }
                });
                
                renderLists(lists);
            });

            // Initial load
            loadLists();

            // Load reviews
            const reviewsList = document.getElementById('reviewsList');
            let reviewsSnap;
            try {
                const reviewsQuery = query(
                    collection(db, 'reviews'),
                    where('userId', '==', user.uid),
                    orderBy('updatedAt', 'desc')
                );
                reviewsSnap = await getDocs(reviewsQuery);
                document.getElementById('reviewsCount').textContent = reviewsSnap.size;
            } catch (err) {
                console.warn('Reviews query failed:', err);
                reviewsSnap = { empty: true, forEach: () => {} };
                document.getElementById('reviewsCount').textContent = '0';
            }

            if (reviewsSnap.empty) {
                reviewsList.innerHTML = `
                    <div class="text-gray-200">
                        You haven't written any reviews yet. 
                        <a href="forest.html" class="text-forest-accent hover:text-forest-accent/80">Find a book to get started!</a>
                    </div>
                `;
            } else {
                reviewsList.innerHTML = '';
                reviewsSnap.forEach(doc => {
                    const data = doc.data();
                    const div = document.createElement('div');
                    div.className = 'bg-forest-secondary p-6 rounded-lg';
                    
                    // Create star rating HTML
                    const stars = '★'.repeat(data.rating) + '☆'.repeat(5 - data.rating);
                    
                    div.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div class="flex-grow">
                                <h3 class="font-bold text-white text-lg">${data.bookTitle}</h3>
                                <div class="text-yellow-400 my-2">${stars}</div>
                                <p class="text-gray-200 mt-2">${data.reviewText.substring(0, 150)}${data.reviewText.length > 150 ? '...' : ''}</p>
                            </div>
                            <div class="flex space-x-3 ml-4">
                                <button onclick="editReview('${doc.id}')" class="text-gray-200 hover:text-white transition-colors duration-300" title="Edit review">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                    </svg>
                                </button>
                                <button onclick="deleteReview('${doc.id}')" class="text-gray-200 hover:text-white transition-colors duration-300" title="Delete review">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    `;
                    reviewsList.appendChild(div);
                });
            }

            // Initialize Forest Name system
            try {
                await import('./js/forestNameService.js');
                await import('./js/forestNameFirestore.js').then(async ({ initializeFromFirestore, getUserForestName, assignNewForestName }) => {
                    // Initialize with existing names
                    await initializeFromFirestore();

                    // Get or generate user's forest name
                    const forestNameInput = document.getElementById('forestName');
                    const regenerateBtn = document.getElementById('regenerateForestName');
                    
                    if (forestNameInput && regenerateBtn) {
                        // Get existing forest name
                        const currentName = await getUserForestName(user.uid);
                        if (currentName) {
                            forestNameInput.value = currentName;
                        } else {
                            // Generate new name for new users
                            try {
                                const newName = await assignNewForestName(user.uid);
                                forestNameInput.value = newName;
                            } catch (err) {
                                console.error('Failed to assign forest name:', err);
                                forestNameInput.value = 'Failed to generate name';
                            }
                        }

                        // Handle regenerate button
                        regenerateBtn.addEventListener('click', async () => {
                            try {
                                const newName = await assignNewForestName(user.uid);
                                forestNameInput.value = newName;
                            } catch (err) {
                                console.error('Failed to regenerate forest name:', err);
                                alert('Failed to generate new name. Please try again.');
                            }
                        });
                    }
                });
            } catch (err) {
                console.error('Failed to initialize Forest Name system:', err);
            }

            // Check creator application status
            try {
                const userDoc = await getDoc(doc(db, 'users', user.uid));
                const data = userDoc.exists() ? userDoc.data() : {};
                
                // Show appropriate application UI
                const applicationStatus = data.applicationStatus;
                const statusEl = document.getElementById('creatorApplicationStatus');
                const ctaEl = document.getElementById('creatorApplicationCTA');
                
                if (applicationStatus === 'pending') {
                    statusEl?.classList.remove('hidden');
                    ctaEl?.classList.add('hidden');
                } else if (applicationStatus === 'approved') {
                    statusEl?.classList.add('hidden');
                    ctaEl?.classList.add('hidden');
                    document.getElementById('creatorResources')?.classList.remove('hidden');
                } else {
                    statusEl?.classList.add('hidden');
                    ctaEl?.classList.remove('hidden');
                }

            } catch (err) {
                console.warn('Failed to check creator status:', err);
            }

            // Load & bind Settings form
            try {
                const settingsForm = document.getElementById('settingsForm');
                const statusEl = document.getElementById('settingsStatus');
                if (settingsForm) {
                    const userDoc = await getDoc(doc(db, 'users', user.uid));
                    const data = userDoc.exists() ? userDoc.data() : {};
                    ['website','medium','twitter','instagram','bluesky','youtube','tiktok'].forEach(id => {
                        const el = document.getElementById(id);
                        if (el && data?.links?.[id]) el.value = data.links[id];
                    });
                    settingsForm.addEventListener('submit', async (ev) => {
                        ev.preventDefault();
                        const links = {
                            website: document.getElementById('website')?.value?.trim() || '',
                            medium: document.getElementById('medium')?.value?.trim() || '',
                            twitter: document.getElementById('twitter')?.value?.trim() || '',
                            instagram: document.getElementById('instagram')?.value?.trim() || '',
                            bluesky: document.getElementById('bluesky')?.value?.trim() || '',
                            youtube: document.getElementById('youtube')?.value?.trim() || '',
                            tiktok: document.getElementById('tiktok')?.value?.trim() || '',
                        };
                        try {
                            await setDoc(doc(db, 'users', user.uid), { links }, { merge: true });
                            if (statusEl) { statusEl.textContent = 'Settings saved.'; setTimeout(()=> statusEl.textContent='', 2000); }
                        } catch (e) {
                            console.error('Save settings failed', e);
                            if (statusEl) statusEl.textContent = 'Failed to save settings.';
                        }
                    });
                }
            } catch (err) {
                console.warn('Settings load failed:', err);
            }

            // (sign out handler already wired above)
        });

        // Book management functions
        window.editBook = (bookId) => {
            window.location.href = `edit-book.html?id=${bookId}`;
        };

                    window.removeFromReadingList = async (bookId) => {
                if (!confirm('Remove this book from your reading list?')) return;
                try {
                    await deleteDoc(doc(db, 'readingList', bookId));
                    location.reload(); // Refresh to update the list
                } catch (error) {
                    console.error('Error removing book from reading list:', error);
                    alert('Error removing book. Please try again.');
                }
            };

            window.markAsRead = async (readingListId, title, buttonElement) => {
                if (!confirm(`Mark "${title}" as read? This will remove it from your reading list.`)) return;
                try {
                    // Remove from reading list
                    await deleteDoc(doc(db, 'readingList', readingListId));
                    
                    // Add to read books collection (optional - for future features)
                    await addDoc(collection(db, 'readBooks'), {
                        userId: user.uid,
                        title: title,
                        readAt: serverTimestamp()
                    });
                    
                    // Show success message
                    buttonElement.innerHTML = '✓ Read';
                    buttonElement.disabled = true;
                    buttonElement.classList.add('opacity-50');
                    
                    // Refresh after delay
                    setTimeout(() => location.reload(), 1000);
                } catch (error) {
                    console.error('Error marking book as read:', error);
                    alert('Error updating book status. Please try again.');
                }
            };

            // Review management functions
            window.editReview = (reviewId) => {
                window.location.href = `edit-review.html?id=${reviewId}`;
            };

            window.deleteReview = async (reviewId) => {
                if (!confirm('Are you sure you want to delete this review? This action cannot be undone.')) return;
                
                try {
                    await deleteDoc(doc(db, 'reviews', reviewId));
                    // The review list will automatically update due to the real-time listener
                } catch (error) {
                    console.error('Error deleting review:', error);
                    alert('Error deleting review. Please try again.');
                }
            };
        });
    </script>
<div id="navOverlay" class="nav-overlay"></div>
<script src="assets/nav.js"></script>
</body>
</html>
